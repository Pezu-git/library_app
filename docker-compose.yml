services: 
  library:
    container_name: lib
    build: . 
    # image: dockerpezu/library:0.0.1
    ports:
      - 8080:8080
    environment: 
      - PORT=5002
      - COUNTER_URL=http://cnt:8081/counter/
      - URL_DB=mongodb://localhost:27017/libraryDB
    networks:
      - mynet
  counter:
    container_name: cnt
    image: dockerpezu/counter:0.0.1
    environment: 
      - PORT=5002
      - REDIS_URL=redis://storage
    working_dir: /app
    volumes:
      - ./src:/src
    depends_on:
      - storage
    networks:
      - mynet
  storage:
    image: redis
    volumes:
      - ./redis/data:/data
    networks:
      - mynet
networks:
  mynet:
    driver: bridge
    ipam:
      driver: default